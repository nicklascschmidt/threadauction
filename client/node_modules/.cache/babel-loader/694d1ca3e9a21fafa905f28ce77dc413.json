{"ast":null,"code":"import _defineProperty from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/src/pages/product/product.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport { validateUserInputs } from './bidValidation';\nimport ErrorBox from '../../components/box/errorBox';\nimport { calculateCreatedAt, calculateTimeRemaining, showDurationTimeRemaining } from '../../components/timeConverter/timeConverter';\nimport './product-style.css';\n\nvar Product =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Product, _React$Component);\n\n  function Product(props) {\n    var _this;\n\n    _classCallCheck(this, Product);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Product).call(this, props));\n\n    _this.componentDidMount = function () {\n      _this.setState({\n        auctionId: _this.props.match.params.auctionId,\n        loading: true,\n        errorArray: [],\n        isError: null\n      }, function () {\n        _this.pullProductDataFromDb(_this.state.auctionId);\n      });\n    };\n\n    _this.pullProductDataFromDb = function (auctionId) {\n      axios.get(\"/api/auctions/\".concat(auctionId)).then(function (resp) {\n        if (resp.status === 200) {\n          var _resp$data = resp.data,\n              title = _resp$data.title,\n              imgLink = _resp$data.imgLink,\n              description = _resp$data.description,\n              gender = _resp$data.gender,\n              category = _resp$data.category,\n              startingPrice = _resp$data.startingPrice,\n              minBidIncrement = _resp$data.minBidIncrement,\n              createdAt = _resp$data.createdAt,\n              loading = _resp$data.loading;\n\n          _this.setState({\n            title: title,\n            imgLink: imgLink,\n            description: description,\n            gender: gender,\n            category: category,\n            startingPrice: startingPrice,\n            minBidIncrement: minBidIncrement,\n            createdAt: createdAt,\n            loading: false\n          });\n        }\n      }).catch(function (err) {\n        _this.setState({\n          errorMsg: \"We ran into an issue trying to find the product. Please reload the page.\",\n          isError: true\n        });\n      }); // Pull bid data for the highest bid. If null, no bids have been placed yet.\n\n      axios.get(\"/api/auctionBids/highestBid/\".concat(auctionId)).then(function (resp) {\n        if (resp.status === 200) {\n          _this.setState({\n            currentHighestBid: resp.data !== null ? resp.data : '',\n            loading: false\n          });\n        }\n      }).catch(function (err) {\n        _this.setState({\n          errorMsg: \"We ran into an issue trying to find the bid. Please reload the page.\",\n          isError: true\n        });\n      });\n    };\n\n    _this.calculateTimeRemaining = function (type) {\n      if (type === 'durationTimeRemaining') {\n        return _this.showTimeRemaining(_this.state.createdAt);\n      } else if (type === 'createdAt') {\n        return calculateCreatedAt(_this.state.createdAt);\n      } else {\n        return React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, \"error\");\n      }\n    };\n\n    _this.showTimeRemaining = function (createdAt) {\n      var momentTimeRemaining = calculateTimeRemaining(createdAt);\n      var durationTimeRemainingObj = showDurationTimeRemaining(momentTimeRemaining);\n\n      if (durationTimeRemainingObj.isComplete) {\n        return React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, \"Auction Complete\"));\n      } else {\n        return React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, \"Time Remaining: \"), durationTimeRemainingObj.days, \"d \", durationTimeRemainingObj.hours, \"h \", durationTimeRemainingObj.minutes, \"m\");\n      }\n    };\n\n    _this.handlePlaceBid = function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        loading: true\n      }, function () {\n        return _this.validateBid(_this.state);\n      });\n    };\n\n    _this.validateBid = function (userBidObj) {\n      var errorObj = validateUserInputs(userBidObj);\n\n      _this.setState({\n        errorArray: errorObj.errorArray,\n        isValidationError: errorObj.isValidationError\n      });\n\n      var bidData = {\n        UserId: _this.props.userId,\n        AuctionId: _this.state.auctionId,\n        bidAmount: parseInt(_this.state.userBid),\n        bidSubmitTime: Date.now() // if validateBid returns an error, then show to the user. Else, run sendUserBidToDb.\n\n      };\n\n      if (errorObj.isValidationError) {\n        _this.setState({\n          loading: false\n        });\n      } else {\n        _this.sendUserBidToDb(bidData);\n      }\n    };\n\n    _this.sendUserBidToDb = function (data) {\n      axios.post('/api/auctionBids/create', data).then(function (resp) {\n        console.log('resp.data', resp.data);\n\n        if (resp.status === 200) {\n          _this.setState({\n            submitted: true,\n            loading: false,\n            errorArray: [],\n            isError: false\n          });\n        }\n      }).catch(function (err) {\n        console.log(err);\n\n        _this.setState({\n          errorArray: ['There was a problem saving your bid.']\n        });\n      });\n    };\n\n    _this.displayErrors = function () {\n      return _this.state.errorArray.map(function (errorMsg, n) {\n        return React.createElement(\"p\", {\n          key: n,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, errorMsg);\n      });\n    };\n\n    _this.handleChange = function (event) {\n      var _event$target = event.target,\n          name = _event$target.name,\n          value = _event$target.value;\n\n      _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.componentDidUpdate = function () {\n      if (_this.state.submitted) {\n        // window.location = '/login';\n        // console.log('~~~~~~ SUBMITTED ~~~~~~');\n        _this.setState({\n          userBid: '',\n          submitted: false\n        }, function () {\n          _this.pullProductDataFromDb(_this.state.auctionId);\n        });\n      }\n    };\n\n    _this.state = {\n      auctionId: '',\n      title: '',\n      imgLink: '',\n      description: '',\n      gender: '',\n      category: '',\n      startingPrice: '',\n      currentHighestBid: '',\n      minBidIncrement: '',\n      createdAt: '',\n      userBid: '',\n      submitted: false,\n      loading: false,\n      errorArray: [],\n      isError: null,\n      isValidationError: null\n    };\n    _this.pullProductDataFromDb = _this.pullProductDataFromDb.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handlePlaceBid = _this.handlePlaceBid.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Product, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, this.state.isError ? React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, this.state.errorMsg) : React.createElement(\"div\", {\n        className: \"box-style-product\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-4 d-flex align-content-center flex-wrap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"img-container-product\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: this.state.imgLink,\n        height: \"300px\",\n        width: \"300px\",\n        alt: \"\",\n        className: \"img-custom-product\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"col-8 row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, this.state.title), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, this.state.description), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"col-7\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, \"Gender: \"), this.state.gender), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"Category: \"), this.state.category), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"Starting Price: \"), \"$\", this.state.startingPrice), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, \"Minimum Bid Increment: \"), \"$\", this.state.minBidIncrement), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, \"Posted: \"), this.calculateTimeRemaining('createdAt')), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, this.calculateTimeRemaining('durationTimeRemaining'))), React.createElement(\"div\", {\n        className: \"col-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, this.state.currentHighestBid && React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, \"Current Highest Bid: \"), \"$\", this.state.currentHighestBid), this.props.username ? React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"Enter Bid ($): \")), React.createElement(\"input\", {\n        className: \"vertical-margin\",\n        type: \"text\",\n        name: \"userBid\",\n        value: this.state.userBid,\n        onChange: function onChange(event) {\n          return _this2.handleChange(event);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        onClick: this.handlePlaceBid,\n        className: \"btn btn-info button-style\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, \"Place Bid\")) : React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, \"Please sign in to a place bid.\")))), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"col-8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, this.state.isValidationError ? React.createElement(ErrorBox, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, this.displayErrors()) : ''))));\n    }\n  }]);\n\n  return Product;\n}(React.Component);\n\nfunction mapStateToProps(state) {\n  return {\n    username: state.username,\n    userId: state.userId,\n    isLoggedIn: true\n  };\n}\n\nexport default connect(mapStateToProps)(Product);","map":{"version":3,"sources":["/Users/nicklascschmidt/Code/Nicky/threadauction/client/src/pages/product/product.js"],"names":["React","connect","axios","validateUserInputs","ErrorBox","calculateCreatedAt","calculateTimeRemaining","showDurationTimeRemaining","Product","props","componentDidMount","setState","auctionId","match","params","loading","errorArray","isError","pullProductDataFromDb","state","get","then","resp","status","data","title","imgLink","description","gender","category","startingPrice","minBidIncrement","createdAt","catch","err","errorMsg","currentHighestBid","type","showTimeRemaining","momentTimeRemaining","durationTimeRemainingObj","isComplete","days","hours","minutes","handlePlaceBid","event","preventDefault","validateBid","userBidObj","errorObj","isValidationError","bidData","UserId","userId","AuctionId","bidAmount","parseInt","userBid","bidSubmitTime","Date","now","sendUserBidToDb","post","console","log","submitted","displayErrors","map","n","handleChange","target","name","value","componentDidUpdate","bind","username","Component","mapStateToProps","isLoggedIn"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport { validateUserInputs } from './bidValidation';\nimport ErrorBox from '../../components/box/errorBox';\nimport { calculateCreatedAt, calculateTimeRemaining, showDurationTimeRemaining } from '../../components/timeConverter/timeConverter';\nimport './product-style.css';\n\nclass Product extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      auctionId: '',\n      title: '',\n      imgLink: '',\n      description: '',\n      gender: '',\n      category: '',\n      startingPrice: '',\n      currentHighestBid: '',\n      minBidIncrement: '',\n      createdAt: '',\n\n      userBid: '',\n\n      submitted: false,\n      loading: false,\n      errorArray: [],\n      isError: null,\n      isValidationError: null\n    }\n    this.pullProductDataFromDb = this.pullProductDataFromDb.bind(this);\n    this.handlePlaceBid = this.handlePlaceBid.bind(this);\n  }\n\n  componentDidMount = () => {\n    this.setState({\n      auctionId: this.props.match.params.auctionId,\n      loading: true,\n      errorArray: [],\n      isError: null\n    }, () => {\n      this.pullProductDataFromDb(this.state.auctionId);\n    })\n  }\n\n  // First pull auction product data, then pull auction bid data.\n  pullProductDataFromDb = (auctionId) => {\n    axios.get(`/api/auctions/${auctionId}`)\n      .then(resp => {\n        if (resp.status === 200) {\n          let { title, imgLink, description, gender, category, startingPrice, minBidIncrement, createdAt, loading } = resp.data;\n          this.setState({\n            title, imgLink, description, gender, category, startingPrice, minBidIncrement, createdAt,\n            loading: false\n          });\n        }\n      }).catch(err => {\n        this.setState({\n          errorMsg: `We ran into an issue trying to find the product. Please reload the page.`,\n          isError: true\n        });\n      });\n\n    // Pull bid data for the highest bid. If null, no bids have been placed yet.\n    axios.get(`/api/auctionBids/highestBid/${auctionId}`)\n      .then(resp => {\n        if (resp.status === 200) {\n          this.setState({\n            currentHighestBid: (resp.data !== null) ? resp.data : '',\n            loading: false\n          });\n        }\n      }).catch(err => {\n        this.setState({\n          errorMsg: `We ran into an issue trying to find the bid. Please reload the page.`,\n          isError: true\n        });\n      });\n  }\n\n  calculateTimeRemaining = (type) => {\n    if (type === 'durationTimeRemaining') {\n      return this.showTimeRemaining(this.state.createdAt);\n    } else if (type === 'createdAt') {\n      return calculateCreatedAt(this.state.createdAt);\n    } else {\n      return <span>error</span>\n    }\n  }\n\n  showTimeRemaining = (createdAt) => {\n    let momentTimeRemaining = calculateTimeRemaining(createdAt);\n    let durationTimeRemainingObj = showDurationTimeRemaining(momentTimeRemaining);\n\n    if (durationTimeRemainingObj.isComplete) {\n      return <span><strong>Auction Complete</strong></span>\n    } else {\n      return <span><strong>Time Remaining: </strong>{durationTimeRemainingObj.days}d {durationTimeRemainingObj.hours}h {durationTimeRemainingObj.minutes}m</span>\n    }\n  }\n\n  handlePlaceBid = (event) => {\n    event.preventDefault();\n    this.setState({ loading: true }, () => this.validateBid(this.state));\n  }\n\n  validateBid = (userBidObj) => {\n    let errorObj = validateUserInputs(userBidObj);\n    this.setState({\n      errorArray: errorObj.errorArray,\n      isValidationError: errorObj.isValidationError\n    })\n\n    let bidData = {\n      UserId: this.props.userId,\n      AuctionId: this.state.auctionId,\n      bidAmount: parseInt(this.state.userBid),\n      bidSubmitTime: Date.now()\n    }\n\n    // if validateBid returns an error, then show to the user. Else, run sendUserBidToDb.\n    if (errorObj.isValidationError) {\n      this.setState({ loading: false });\n    } else {\n      this.sendUserBidToDb(bidData);\n    }\n  }\n\n  sendUserBidToDb = (data) => {\n    axios.post('/api/auctionBids/create', data)\n      .then(resp => {\n        console.log('resp.data',resp.data);\n        if (resp.status === 200) {\n          this.setState({\n            submitted: true,\n            loading: false,\n            errorArray: [],\n            isError: false\n          });\n        }\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          errorArray: ['There was a problem saving your bid.']\n        });\n      });\n  }\n\n  displayErrors = () => {\n    return this.state.errorArray.map((errorMsg, n) => {\n      return <p key={n}>{errorMsg}</p>\n    })\n  }\n\n  handleChange = (event) => {\n    const { name, value } = event.target;\n    this.setState({ [name]: value })\n  }\n\n  componentDidUpdate = () => {\n    if (this.state.submitted) {\n      // window.location = '/login';\n      // console.log('~~~~~~ SUBMITTED ~~~~~~');\n      this.setState({\n        userBid: '',\n        submitted: false\n      }, () => {\n        this.pullProductDataFromDb(this.state.auctionId);\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div className='container'>\n        {this.state.isError\n          ? <h3>{this.state.errorMsg}</h3>\n          : (\n            <div className='box-style-product'>\n              <div className='row'>\n                <div className='col-4 d-flex align-content-center flex-wrap'>\n                  <div className='img-container-product'>\n                    <img src={this.state.imgLink} height='300px' width='300px' alt='' className='img-custom-product' />\n                  </div>\n                </div>\n                <div className='col-8 row'>\n                  <h3>{this.state.title}</h3>\n                  <p>{this.state.description}</p>\n                  <hr></hr>\n                  <div className='col-7'>\n                    <p><strong>Gender: </strong>{this.state.gender}</p>\n                    <p><strong>Category: </strong>{this.state.category}</p>\n                    <p><strong>Starting Price: </strong>${this.state.startingPrice}</p>\n                    <p><strong>Minimum Bid Increment: </strong>${this.state.minBidIncrement}</p>\n                    <p><strong>Posted: </strong>{this.calculateTimeRemaining('createdAt')}</p>\n                    <p>{this.calculateTimeRemaining('durationTimeRemaining')}</p>\n                  </div>\n                  <div className='col-5'>\n                    {this.state.currentHighestBid && <p><strong>Current Highest Bid: </strong>${this.state.currentHighestBid}</p>}\n                    {this.props.username\n                      ? <form>\n                        <div>\n                          <span><strong>Enter Bid ($): </strong></span>\n                          <input\n                            className='vertical-margin'\n                            type=\"text\"\n                            name=\"userBid\"\n                            value={this.state.userBid}\n                            onChange={event => this.handleChange(event)}\n                          />\n                        </div>\n                        <button onClick={this.handlePlaceBid} className='btn btn-info button-style'>Place Bid</button>\n                      </form>\n                      : <h5>Please sign in to a place bid.</h5>}\n                  </div>\n                </div>\n              </div>\n              <div className='row'>\n                <div className='col-4'></div>\n                <div className='col-8'>\n                  {this.state.isValidationError ? <ErrorBox >{this.displayErrors()}</ErrorBox> : ''}\n                </div>\n              </div>\n            </div>\n          )}\n      </div>\n    )\n  }\n}\n\nfunction mapStateToProps(state) {\n  return {\n    username: state.username,\n    userId: state.userId,\n    isLoggedIn: true\n  };\n}\n\nexport default connect(mapStateToProps)(Product);\n"]},"metadata":{},"sourceType":"module"}