{"ast":null,"code":"import _toConsumableArray from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/nicklascschmidt/Code/Nicky/threadauction/client/src/pages/orderHistory/orderHistory.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport ProductListingBidHistory from \"../../components/productListing/productListingBidHistory\"; // import PrettyProfile from './orderHistoryStyles';\n\nimport './orderHistory-style.css';\n\nvar OrderHistory =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(OrderHistory, _React$Component);\n\n  function OrderHistory(props) {\n    var _this;\n\n    _classCallCheck(this, OrderHistory);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrderHistory).call(this, props));\n\n    _this.componentDidMount = function () {\n      _this.setState({\n        userId: _this.props.userId,\n        username: _this.props.username,\n        bidArray: [],\n        auctionArray: [],\n        errorArray: [],\n        isError: null\n      }, function () {\n        _this.pullBidsFromDb(_this.state.userId);\n      });\n    };\n\n    _this.pullBidsFromDb = function (userId) {\n      // console.log('Pulling users bids from the DB with this ID: ',userId);\n      var params = {\n        userId: userId\n      };\n      axios.get('/api/bid/auctionBids', {\n        params: params\n      }).then(function (resp) {\n        _this.setState({\n          bidArray: resp.data\n        }, function () {\n          // console.log('These are all the bids the user has placed: ',this.state.bidArray);\n          _this.getAuctionIds(_this.state.bidArray);\n        });\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.displayBids = function (bidArray, auctionArray) {\n      console.log('displaying bids...', bidArray, auctionArray);\n      var bidArrayMapped = bidArray.map(function (bid) {\n        return React.createElement(\"div\", {\n          key: bid.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }, _this.findAuctionWithID(bid, auctionArray));\n      });\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, bidArrayMapped);\n    };\n\n    _this.state = {\n      userId: '',\n      username: '',\n      bidArray: [],\n      // every bid the user has cast\n      auctionIdArray: [],\n      // auctionIds that the user has taken part in\n      auctionArray: [] // array of auctions that the user has placed bids for\n\n    };\n    return _this;\n  }\n\n  _createClass(OrderHistory, [{\n    key: \"getAuctionIds\",\n    value: function getAuctionIds(bidArray) {\n      var _this2 = this;\n\n      // console.log('getting auction IDs...');\n      var auctionIdArray = [];\n      bidArray.map(function (bid) {\n        auctionIdArray.push(bid.AuctionId);\n      });\n\n      var removeDupes = function removeDupes(a) {\n        return _toConsumableArray(new Set(a));\n      };\n\n      var removeDupeArray = removeDupes(auctionIdArray);\n      this.setState({\n        auctionIdArray: removeDupeArray\n      }, function () {\n        //   console.log('These are the IDs of the auctions: ',this.state.auctionIdArray);\n        _this2.loopAuctionsForProductInfo(_this2.state.auctionIdArray);\n      });\n    }\n  }, {\n    key: \"findAuctionWithID\",\n    value: function findAuctionWithID(bid, auctionArray) {\n      // console.log('looking for the auction...',auctionID,auctionArray)\n      var auctionMapped = auctionArray.map(function (auction) {\n        if (auction.id === bid.AuctionId) {\n          return React.createElement(ProductListingBidHistory, {\n            key: auction.id,\n            auctionId: auction.id,\n            imgLink: auction.imgLink,\n            title: auction.title,\n            startingPrice: auction.startingPrice,\n            createdAt: auction.createdAt,\n            bid: bid,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 88\n            },\n            __self: this\n          });\n        }\n      });\n      return auctionMapped;\n    }\n  }, {\n    key: \"loopAuctionsForProductInfo\",\n    value: function loopAuctionsForProductInfo(auctionIdArray) {\n      var _this3 = this;\n\n      console.log('Now, we\\'re looping through the auction array and pulling data for each one. We\\'ll map it after.');\n      var bidPromises = [];\n\n      var _loop = function _loop(n) {\n        bidPromises.push(new Promise(function (resolve, reject) {\n          _this3.fetchAuctionFromDb(auctionIdArray[n]).then(function (resp) {\n            resolve(resp.data);\n          }).catch(function (err) {\n            reject(err);\n          });\n        }));\n      };\n\n      for (var n = 0; n < auctionIdArray.length; n++) {\n        _loop(n);\n      }\n\n      Promise.all(bidPromises).then(function (bidPromiseData) {\n        var filteredArray = bidPromiseData.filter(function (value) {\n          return value != '';\n        });\n\n        _this3.setState({\n          auctionArray: filteredArray\n        }, function () {\n          console.log(\"auctionArray has been set: \", _this3.state.auctionArray);\n        });\n      }).catch(function (err) {\n        console.log('an error occurred: ', err);\n      });\n    } // Returns a promise\n\n  }, {\n    key: \"fetchAuctionFromDb\",\n    value: function fetchAuctionFromDb(auctionId) {\n      var params = {\n        auctionId: auctionId\n      };\n      return axios.get('/api/auction/id', {\n        params: params\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"container center-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, \"My Bid History\"), this.state.bidArray.length > 0 ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, this.displayBids(this.state.bidArray, this.state.auctionArray)) : React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"No bids to show.\"));\n    }\n  }]);\n\n  return OrderHistory;\n}(React.Component);\n\nfunction mapStateToProps(state) {\n  console.log('OrderHistory: mapStateToProps state', state);\n  return {\n    username: state.username,\n    userId: state.userId,\n    isLoggedIn: true\n  };\n}\n\nexport default connect(mapStateToProps)(OrderHistory);","map":{"version":3,"sources":["/Users/nicklascschmidt/Code/Nicky/threadauction/client/src/pages/orderHistory/orderHistory.js"],"names":["React","connect","axios","ProductListingBidHistory","OrderHistory","props","componentDidMount","setState","userId","username","bidArray","auctionArray","errorArray","isError","pullBidsFromDb","state","params","get","then","resp","data","getAuctionIds","catch","err","console","log","displayBids","bidArrayMapped","map","bid","id","findAuctionWithID","auctionIdArray","push","AuctionId","removeDupes","a","Set","removeDupeArray","loopAuctionsForProductInfo","auctionMapped","auction","imgLink","title","startingPrice","createdAt","bidPromises","n","Promise","resolve","reject","fetchAuctionFromDb","length","all","bidPromiseData","filteredArray","filter","value","auctionId","Component","mapStateToProps","isLoggedIn"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport ProductListingBidHistory from \"../../components/productListing/productListingBidHistory\";\n// import PrettyProfile from './orderHistoryStyles';\nimport './orderHistory-style.css';\n\nclass OrderHistory extends React.Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            userId: '',\n            username: '',\n            bidArray: [], // every bid the user has cast\n            auctionIdArray: [], // auctionIds that the user has taken part in\n            auctionArray: [], // array of auctions that the user has placed bids for\n        }\n    }\n\n    componentDidMount = () => {\n        this.setState({\n            userId: this.props.userId,\n            username: this.props.username,\n            bidArray: [],\n            auctionArray: [],\n\n            errorArray: [],\n            isError: null\n        }, () => {\n            this.pullBidsFromDb(this.state.userId);\n        })\n    }\n\n    \n    pullBidsFromDb = (userId) => {\n        // console.log('Pulling users bids from the DB with this ID: ',userId);\n        const params = { userId };\n        axios.get('/api/bid/auctionBids', { params })\n        .then(resp => {\n            this.setState({\n                bidArray: resp.data,\n            }, () => {\n                // console.log('These are all the bids the user has placed: ',this.state.bidArray);\n                this.getAuctionIds(this.state.bidArray);\n            })\n        }).catch(err => {\n            console.log(err);\n        });\n    }\n\n    getAuctionIds(bidArray) {\n        // console.log('getting auction IDs...');\n        let auctionIdArray = [];\n        bidArray.map( (bid) => {\n            auctionIdArray.push(bid.AuctionId);\n        })\n        let removeDupes = (a) => [...new Set(a)];\n        const removeDupeArray = removeDupes(auctionIdArray);\n\n        this.setState({\n            auctionIdArray: removeDupeArray\n        }, () => {\n        //   console.log('These are the IDs of the auctions: ',this.state.auctionIdArray);\n          this.loopAuctionsForProductInfo(this.state.auctionIdArray);\n        })\n    }\n\n    displayBids = (bidArray,auctionArray) => {\n        console.log('displaying bids...',bidArray,auctionArray);\n        const bidArrayMapped = bidArray.map( (bid) => {\n            return (\n                <div key={bid.id}>\n                    {this.findAuctionWithID(bid,auctionArray)}\n                    {/* <p>Bid Submitted At: {calculateCreatedAt(bid.bidSubmitTime)}</p>\n                    <p>Bid Amount: ${bid.bidAmount}</p> */}\n                </div>\n            )\n        })\n        return <div>{bidArrayMapped}</div>\n    }\n\n    findAuctionWithID(bid,auctionArray) {\n        // console.log('looking for the auction...',auctionID,auctionArray)\n        const auctionMapped = auctionArray.map( (auction) => {\n            if (auction.id === bid.AuctionId) {\n                return (\n                    <ProductListingBidHistory\n                        key={auction.id}\n                        auctionId={auction.id}\n                        imgLink={auction.imgLink}\n                        title={auction.title}\n                        startingPrice={auction.startingPrice}\n                        createdAt={auction.createdAt}\n                        bid={bid}\n                    />\n                )\n            }\n        })\n        return auctionMapped\n    }\n\n    loopAuctionsForProductInfo(auctionIdArray) {\n        console.log('Now, we\\'re looping through the auction array and pulling data for each one. We\\'ll map it after.');\n    \n        const bidPromises = [];\n        for (let n=0; n<auctionIdArray.length; n++) {\n          bidPromises.push(new Promise( (resolve, reject) => {\n            this.fetchAuctionFromDb(auctionIdArray[n])\n              .then(resp => {\n                resolve(resp.data);\n              }).catch(err => {\n                reject(err);\n              })\n          }))\n        }\n    \n        Promise.all(bidPromises).then(bidPromiseData => {\n          const filteredArray = bidPromiseData.filter( (value) => {\n            return value != '';\n          })\n          this.setState({\n            auctionArray: filteredArray\n          }, () => {\n            console.log(\"auctionArray has been set: \",this.state.auctionArray);\n          })\n        }).catch(err => {\n          console.log('an error occurred: ',err);\n        })\n    }\n\n    // Returns a promise\n    fetchAuctionFromDb(auctionId) {\n        const params = { auctionId };\n        return axios.get('/api/auction/id', { params })\n    }\n    \n    \n    render() {\n        return(\n            <div className='container center-content'>\n                <h2>My Bid History</h2>\n                \n                {this.state.bidArray.length > 0 ? <div>{this.displayBids(this.state.bidArray,this.state.auctionArray)}</div> : <p>No bids to show.</p>}\n\n            </div>\n        )\n    }\n}\n\nfunction mapStateToProps(state) {\n    console.log('OrderHistory: mapStateToProps state',state);\n    return {\n      username: state.username,\n      userId: state.userId,\n      isLoggedIn: true\n    };\n}\n\nexport default connect(mapStateToProps)(OrderHistory);\n"]},"metadata":{},"sourceType":"module"}